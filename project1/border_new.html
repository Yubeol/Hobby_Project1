<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>글쓰기 | HOBBY</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<style>
  :root{
    --primary:#E2B8AC; --primary-strong:#C79A8C;
    --info:#98A7AC; --muted:#6b7280; --ink:#111; --line:#eceef2;
    --muted-bg:#AAD9CD; --surface:#CDDAD8;
    --rail: 920px;
    --chip-h:44px; --chip-radius:10px; --chip-fs:13px; --chip-pad-x:10px;
    --chip-col-w:160px; --chip-gap-x:6px; --chip-gap-y:6px;
    /* footer vars */
    --ft-line:#f0f0f0; --ft-ink:#555; --ft-muted:#888; --ft-card:#f8f8f8; --ft-maxw:1080px;
  }
  body{ font-family:'Noto Sans KR','Apple SD Gothic Neo','Malgun Gothic','Segoe UI',Roboto,Arial,sans-serif; color:var(--ink); background:#fff; }

  .top-banner{ background:#f8f9fa; font-size:.9rem; border-bottom:1px solid #eee; }
  .top-banner a{ color:#333; text-decoration:none; margin-left:15px; }

  .navbar-brand{ font-weight:700; color:#111 !important; font-size:2rem; font-family:'Poppins',sans-serif; }
  .divider{ width:1px; height:24px; background:#ddd; margin:0 12px; }
  @media (min-width:992px){ .bar-lg{display:flex!important} .bar-sm{display:none!important} }
  @media (max-width:991.98px){ .bar-lg{display:none!important} .bar-sm{display:flex!important} }
  .search-wrap{ position:relative; flex:1; max-width:480px; }
  .search-bar{ width:100%; border-radius:50px; }
  .search-bar:focus{ border-color:#ced4da !important; box-shadow:none !important; outline:none !important; }
  .icon-row{ display:flex; align-items:center; gap:16px; }
  .nav-icon{ position:relative; margin:0 6px; cursor:pointer; }
  .nav-icon span{ position:absolute; bottom:-22px; left:50%; transform:translateX(-50%); background:#333; color:#fff; padding:2px 6px; border-radius:4px; font-size:12px; white-space:nowrap; opacity:0; transition:opacity .15s; }
  .nav-icon:hover span{ opacity:1; }

  /* Category mega-panel */
  .category-trigger, .category-trigger-sm{ position:relative; }
  .mega-panel{
    position:absolute; top:100%; left:50%; transform:translateX(-50%);
    width:auto; max-width:calc(100vw - 32px);
    margin-top:10px; padding:10px;
    background:#fff; border:1px solid #e5e7eb; border-radius:14px;
    box-shadow:0 16px 36px rgba(0,0,0,.08);
    display:none; z-index:2000;
  }
  .mega-panel.mobile{
    position:absolute; top:calc(100% + 8px); left:0; transform:none; margin-top:0;
    width:max(260px, min(640px, 92vw)); max-width:92vw; padding:10px;
  }
  .mega-grid{
    display:grid; grid-template-columns:repeat(3, var(--chip-col-w));
    gap:var(--chip-gap-y) var(--chip-gap-x); justify-content:center;
  }
  .cat-chip{
    height:var(--chip-h); border:1px solid #dfe3e7; background:#fff;
    border-radius:var(--chip-radius); display:flex; align-items:center; gap:8px;
    padding:0 var(--chip-pad-x); width:100%; box-sizing:border-box; cursor:pointer;
    transition:background-color .12s, border-color .12s; justify-content:center; color:#4b5563;
  }
  .cat-chip:hover{ background: color-mix(in srgb, var(--muted-bg) 22%, white); border-color:#d4d8dd; }
  .chip-badge{ width:22px; height:22px; border-radius:8px; display:grid; place-items:center; font-size:14px; background:#f6f7f8; border:1px solid #eceff2; color:#374151; }
  .cat-title{ font-size:13px; font-weight:500; letter-spacing:-.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; line-height:1; }

  /* Search overlay */
  .search-overlay{ position:absolute; left:0; right:0; top:calc(100% + 8px); background:#fff; border:1px solid #eceef2; border-radius:12px; padding:12px; z-index:2050; display:none; box-shadow:0 8px 24px rgba(0,0,0,.08); }
  .search-overlay[aria-hidden="false"]{ display:block; }
  .so-title{ font-weight:600; font-size:.95rem; color:#374151; margin-bottom:6px; }
  .so-chips{ display:flex; flex-wrap:wrap; gap:8px; }
  .so-chip{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; background:#fff; border:1px solid #e5e7eb; border-radius:999px; font-size:.92rem; color:#374151; cursor:pointer; transition:background .12s, border-color .12s; }
  .so-chip:hover{ background: color-mix(in srgb, var(--muted-bg) 35%, white); border-color:#d7dde3; }

  /* Rail wrapper */
  .rail{ width: min(100% - 32px, var(--rail)); margin: 0 auto; }

  .page-header{ padding:20px 0 8px; border-bottom:1px solid rgba(0,0,0,.04); }
  .page-title{ font-size:1.5rem; font-weight:700; letter-spacing:-.2px; }
  .breadcrumb .breadcrumb-item > a{ color: var(--info); text-decoration:none; }
  .breadcrumb .breadcrumb-item > a:hover{ text-decoration:underline; }
  .breadcrumb .breadcrumb-item.active{ color: var(--primary-strong); font-weight:700; }

  /* Editor */
  .editor-card{ border:1px solid var(--line); border-radius:12px; background:#fff; overflow:hidden; }
  .editor-head{ background:#fafafa; padding:12px; font-weight:700; color:#374151; display:flex; align-items:center; gap:10px; }
  .editor-body{ padding:14px; }
  .editor-foot{ display:flex; gap:8px; justify-content:flex-end; padding:12px 14px; border-top:1px solid #f1f2f6; }
  .editor-foot .btn{ border-radius:10px; }
  .req{ color:#ef4444; }
  .counter{ font-size:.9rem; color:#6b7280; }

  /* Footer */
  .footer-wrap{ background:#fff; margin-top:18px; }
  .footer-viewport{ width:100%; }
  .footer-box{
    margin:24px 0 40px;
    background:var(--ft-card);
    border:1px solid var(--ft-line);
    border-radius:12px;
    padding:20px;
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:16px;
    max-width:var(--ft-maxw);
    margin-left:auto; margin-right:auto;
    color:var(--ft-ink);
  }
  .footer-box .ft-title{ font-weight:600; margin-bottom:6px; display:flex;align-items:center;gap:6px; color:#444; font-size:15px; text-transform:lowercase; }
  .footer-box a{ display:block; color:var(--ft-muted); text-decoration:none; margin:4px 0; font-size:14px; transition:color 0.2s ease; }
  .footer-box a:hover{ color:#555; text-decoration:underline; }

  /* Ensure header/nav stays on top (fix click-blocking) */
  .bar-lg, .bar-sm { position: relative; z-index: 1200; }
  .page-header { position: relative; z-index: 1; }

  .thumb-uploader{ display:grid; grid-template-columns:repeat(auto-fill, minmax(140px, 1fr)); gap:10px; }
  .thumb-tile{ border:1px dashed #dfe3e7; border-radius:12px; padding:10px; text-align:center; color:#6b7280; cursor:pointer; background:#fafafa; }
  .thumb-tile.preview{ position:relative; background:#fff; border-style:solid; }
  .thumb-tile img{ width:100%; height:120px; object-fit:cover; border-radius:8px; }
  .thumb-tile .del{ position:absolute; top:8px; right:8px; width:28px; height:28px; border-radius:50%; background:#fff; border:1px solid rgba(0,0,0,.1); display:grid; place-items:center; cursor:pointer; }
  .helper{ font-size:.9rem; color:#6b7280; }

  .thumb-uploader{ display:grid; grid-template-columns:repeat(auto-fill, minmax(140px, 1fr)); gap:10px; }
  .thumb-tile{ border:1px dashed #dfe3e7; border-radius:12px; padding:10px; text-align:center; color:#6b7280; cursor:pointer; background:#fafafa; }
  .thumb-tile.preview{ position:relative; background:#fff; border-style:solid; }
  .thumb-tile img{ width:100%; height:120px; object-fit:cover; border-radius:8px; }
  .thumb-tile .del{ position:absolute; top:8px; right:8px; width:28px; height:28px; border-radius:50%; background:#fff; border:1px solid rgba(0,0,0,.1); display:grid; place-items:center; cursor:pointer; }
  .helper{ font-size:.9rem; color:#6b7280; }
  .bar-lg, .bar-sm { position: relative; z-index: 1200; }

  /* desktop auth-links: 회원가입 / 로그인 / 공지사항 */
  .auth-links{ gap:4px; }
  .auth-links .auth-link{ text-decoration:none; font-size:.95rem; color:#374151; padding:0 6px; }
  .auth-links .auth-link:hover{ text-decoration:underline; }
  .auth-links .auth-div{ color:#c9ccd2; }

  /* desktop: hide mini banner (아이콘 옆 텍스트 링크로 통일) */
  @media (min-width:992px){ .top-banner{ display:none !important; } }
</style>
</head>
<body>
<div class="top-banner text-end py-1 px-3">
<a href="/accounts/signup/">회원가입</a><a href="/accounts/login/">로그인</a><a href="/community/">공지사항</a>
</div>
<!-- Desktop header -->
<nav class="navbar bg-white border-bottom sticky-top bar-lg">
<div class="container d-flex justify-content-center">
<div class="d-flex align-items-center justify-content-center gap-3 w-100 flex-wrap">
<div class="category-trigger">
<button aria-expanded="false" class="btn btn-link text-dark fs-4" data-bs-placement="bottom" data-bs-toggle="tooltip" id="btnCatDesk" title="카테고리">
<i class="bi bi-grid"></i>
</button>
<div aria-label="카테고리" class="mega-panel" id="panelDesk" role="menu">
<div class="mega-grid" id="gridDesk"></div>
</div>
</div>
<div class="divider"></div>
<a class="navbar-brand" href="/">HOBBY</a>
<form autocomplete="off" class="d-flex search-wrap">
<input aria-hidden="true" style="position:absolute; left:-9999px; top:-9999px; height:0; width:0; opacity:0;" tabindex="-1" type="text"/>
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control search-bar" id="globalSearch" placeholder="지금 생각나는 취미를 검색하세요" spellcheck="false" type="search"/>
<div aria-hidden="true" class="search-overlay shadow-sm" id="searchOverlay" role="dialog">
<div class="so-title">인기 검색어</div>
<div class="so-chips" id="popularChips"></div>
<div class="so-title mt-2 d-flex align-items-center">최근 검색어 <button class="btn btn-sm btn-link p-0 ms-auto" id="clearRecent" type="button">전체삭제</button></div>
<div class="so-chips" id="recentChips"></div>
</div>
</form>
<div class="icon-row">
<div class="nav-icon"><i class="bi bi-people fs-4"></i><span>크루</span></div>
<div class="nav-icon"><i class="bi bi-bell fs-4"></i><span>알림</span></div>
<div class="nav-icon"><i class="bi bi-heart fs-4"></i><span>찜</span></div>
<div class="nav-icon"><i class="bi bi-person fs-4"></i><span>마이</span></div>

          <!-- desktop 텍스트 링크 -->
          <div class="auth-links d-none d-lg-flex align-items-center ms-2">
            <a class="auth-link" href="/accounts/signup/">회원가입</a>
            <span class="auth-div">|</span>
            <a class="auth-link" href="/accounts/login/">로그인</a>
            <span class="auth-div">|</span>
            <a class="auth-link" href="/community/?tab=notice">공지사항</a>
          </div>

</div>
</div>
</div>
</nav>
<!-- Mobile header -->
<nav class="navbar bg-white border-bottom sticky-top bar-sm w-100">
<div class="container-fluid d-flex justify-content-between align-items-center">
<div class="d-flex align-items-center">
<div class="category-trigger-sm">
<button aria-expanded="false" class="btn btn-link text-dark fs-4 me-1" data-bs-placement="bottom" data-bs-toggle="tooltip" id="btnCatM" title="카테고리">
<i class="bi bi-grid"></i>
</button>
<div aria-label="카테고리 (모바일)" class="mega-panel mobile" id="panelM" role="menu">
<div class="mega-grid" id="gridM"></div>
</div>
</div>
<a class="navbar-brand ms-1" href="/">HOBBY</a>
</div>
<button class="navbar-toggler" data-bs-target="#navMenuSm" data-bs-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
</div>
<div class="collapse navbar-collapse bg-white" id="navMenuSm">
<div class="p-3 border-bottom">
<form autocomplete="off" class="input-group">
<input aria-hidden="true" style="position:absolute; left:-9999px; top:-9999px; height:0; width:0; opacity:0;" tabindex="-1" type="text"/>
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="globalSearchSm" placeholder="취미 검색…" spellcheck="false" type="search"/>
<button class="btn btn-outline-secondary" type="button"><i class="bi bi-search"></i></button>
</form>
</div>
<ul class="navbar-nav p-2 gap-1">
<li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-people me-2"></i>크루</a></li>
<li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-bell me-2"></i>알림</a></li>
<li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-heart me-2"></i>찜</a></li>
<li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-person me-2"></i>마이</a></li>
</ul>
</div>
</nav>
<!-- Page header -->
<header class="page-header">
<div class="container">
<div class="rail d-flex align-items-center justify-content-between">
<div class="page-title">글쓰기</div>
<nav aria-label="breadcrumb">
<ol class="breadcrumb mb-0"><li class="breadcrumb-item"><a href="/">Home</a></li><li class="breadcrumb-item"><a href="/community/">커뮤니티</a></li><li class="breadcrumb-item"><a href="/community/?tab=board">자유게시판</a></li><li aria-current="page" class="breadcrumb-item active">글쓰기</li></ol>
</nav>
</div>
</div>
</header>
<main class="py-3">
<div class="container">
<div class="rail">
<form id="boardWriteForm" novalidate="">
<div class="editor-card">
<div class="editor-head"><i class="bi bi-pencil-square"></i> 새 글 작성</div>
<div class="editor-body">
<div class="row g-3">

<div class="col-md-6">
<label class="form-label" for="category">카테고리<span class="req">*</span></label>
<select class="form-select" id="category" name="category" required="">
<option value="">선택하세요</option>
<option>하이킹</option><option>보드게임</option><option>요리</option><option>와인</option>
</select>
</div>
<div class="col-md-6">
<label class="form-label" for="region">지역</label>
<select class="form-select" id="region" name="region">
<option value="">지역 전체</option>
<option>영등포구</option><option>성동구</option><option>관악구</option>
</select>
</div>
<div class="col-12">
<label class="form-label" for="title">제목<span class="req">*</span></label>
<input class="form-control" id="title" maxlength="80" name="title" placeholder="제목을 입력하세요" required="" type="text"/>
<div class="d-flex justify-content-end"><span class="counter"><span id="titleCnt">0</span>/80</span></div>
</div>
<div class="col-12">
<label class="form-label d-flex align-items-center gap-2">사진 업로드 <span class="helper">(최대 5장)</span></label>
<div class="thumb-uploader" id="thumbGrid">
<label class="thumb-tile">
<input accept="image/*" class="d-none" id="thumbInput" multiple="" type="file"/>
<div class="py-4 text-center">
<div class="mb-1"><i class="bi bi-image fs-4"></i></div>
<div>이미지 선택</div>
</div>
</label>
</div>
</div>
<div class="col-12">
<label class="form-label" for="content">내용<span class="req">*</span></label>
<textarea class="form-control" id="content" maxlength="5000" name="content" placeholder="내용을 입력하세요" required="" rows="10"></textarea>
<div class="d-flex justify-content-end mt-1"><span class="counter"><span id="bodyCnt">0</span>/5000</span></div>
</div>
</div>
</div>
<div class="editor-foot">
<button class="btn btn-dark" id="btnSubmit" type="submit"><i class="bi bi-check2-circle me-1"></i>등록</button>
<a class="btn btn-outline-secondary" href="/community/?tab=board">취소</a>
</div>
</div>
</form>
</div>
</div>
</main>
<!-- Footer (same pattern as notice_detail) -->
<section class="footer-wrap">
<div class="container">
<div class="footer-viewport mx-auto" id="ftViewport">
<footer class="footer-box" role="contentinfo">
<div>
<div class="ft-title">help</div>
<a href="#">FAQ</a>
<a href="#">Contact</a>
</div>
<div>
<div class="ft-title">news</div>
<a href="#">Notice</a>
<a href="#">Update</a>
</div>
<div>
<div class="ft-title">instagram</div>
<a href="https://instagram.com/yourbrand" rel="noopener" target="_blank">@yourbrand</a>
</div>
</footer>
</div>
</div>
</section>
<div class="position-fixed end-0 bottom-0 m-3 bg-dark text-white rounded-3 px-3 py-2" id="toast" style="opacity:0; transform:translateY(10px); transition:opacity .2s, transform .2s;"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script><script>
(() => {
  /* Categories chips render (네비 동일) */
  const categories=[
    {title:'아웃도어',emoji:'🏕️'},{title:'피트니스',emoji:'🧘'},{title:'뷰티',emoji:'💄'},{title:'공예·DIY',emoji:'🧶'},
    {title:'스포츠',emoji:'⚽'},{title:'베이킹',emoji:'🍞'},{title:'문화예술',emoji:'🎨'},{title:'자기계발',emoji:'📚'},
    {title:'심리·상담',emoji:'☕'},{title:'수상레포츠',emoji:'🏊'},{title:'요리',emoji:'🍳'},{title:'여행',emoji:'✈️'}
  ];
  const gridDesk=document.getElementById('gridDesk');
  const gridM=document.getElementById('gridM');
  function renderChips(container){
    if(!container) return;
    container.innerHTML = categories.map(c=>(
      '<button type="button" class="cat-chip" data-title="'+c.title+'">'+
        '<div class="chip-badge">'+c.emoji+'</div>'+
        '<div class="cat-title">'+c.title+'</div>'+
      '</button>'
    )).join('');
  }
  renderChips(gridDesk); renderChips(gridM);

  function setUnifiedChipWidth(scope=document){
    const chips=[...scope.querySelectorAll('.cat-chip')]; if(!chips.length) return;
    chips.forEach(ch=>ch.style.width='auto');
    const maxW=Math.ceil(Math.max(...chips.map(ch=>ch.scrollWidth)));
    const clamped=Math.min(Math.max(maxW,120),200);
    document.documentElement.style.setProperty('--chip-col-w',clamped+'px');
    chips.forEach(ch=>ch.style.width='100%');
  }
  setUnifiedChipWidth(document);
  if(document.fonts?.ready) document.fonts.ready.then(()=>setUnifiedChipWidth(document));
  addEventListener('resize', ()=>setUnifiedChipWidth(document));

  const btnCatDesk=document.getElementById('btnCatDesk');
  const panelDesk=document.getElementById('panelDesk');
  function keepPanelOnScreen(panel){
    panel.style.left='50%'; panel.style.right=''; panel.style.transform='translateX(-50%)';
    const prev=panel.style.display; panel.style.display='block';
    const rect=panel.getBoundingClientRect(); const vw=innerWidth; const m=16;
    if(rect.left<m){ panel.style.left=m+'px'; panel.style.right=''; panel.style.transform='none'; }
    else if(rect.right>vw-m){ panel.style.left=''; panel.style.right=m+'px'; panel.style.transform='none'; }
    panel.style.display=prev||'block';
  }
  btnCatDesk?.addEventListener('click',e=>{
    e.preventDefault();
    const open=panelDesk.style.display==='block';
    if(!open){ panelDesk.style.display='block'; keepPanelOnScreen(panelDesk); }
    else{ panelDesk.style.display='none'; }
    btnCatDesk.setAttribute('aria-expanded', String(!open));
  });
  document.addEventListener('click',e=>{
    if(panelDesk && panelDesk.style.display==='block'&&!panelDesk.contains(e.target)&&!btnCatDesk.contains(e.target)){
      panelDesk.style.display='none'; btnCatDesk.setAttribute('aria-expanded','false');
    }
  });

  const btnCatM=document.getElementById('btnCatM');
  const panelM=document.getElementById('panelM');
  function openMobilePanel(){ if(!panelM) return; panelM.style.display='block'; btnCatM?.setAttribute('aria-expanded','true'); setUnifiedChipWidth(panelM); }
  function closeMobilePanel(){ if(!panelM) return; panelM.style.display='none'; btnCatM?.setAttribute('aria-expanded','false'); }
  function panelMHidden(){ return !panelM || panelM.style.display!=='block'; }
  btnCatM?.addEventListener('click',e=>{ e.preventDefault(); panelMHidden()?openMobilePanel():closeMobilePanel(); });
  document.addEventListener('click',e=>{ if(!panelM) return; const isInside=panelM.contains(e.target)||btnCatM?.contains(e.target); if(!isInside&&!panelMHidden()) closeMobilePanel(); });

  // Search overlay same behavior
  (function(){
    const input = document.getElementById('globalSearch');
    const overlay = document.getElementById('searchOverlay');
    const popularEl = document.getElementById('popularChips');
    const recentEl = document.getElementById('recentChips');
    const clearRecentBtn = document.getElementById('clearRecent');
    if(!input || !overlay) return;

    function suppressBrowserSuggestions(el){ el.setAttribute('autocomplete','off'); el.setAttribute('readonly','readonly'); setTimeout(()=>{ el.removeAttribute('readonly'); }, 50); }

    const popular = ['하이킹','보드게임','드로잉','와인클래스','홈쿠킹','사진산책','러닝'];
    const LS_KEY = 'hobby_recent_keywords';
    const getRecent = () => { try { return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); } catch { return []; } };
    const setRecent = (arr) => localStorage.setItem(LS_KEY, JSON.stringify(arr.slice(0,12)));

    function renderChips(list, container, {deletable=false}={}){
      container.innerHTML = '';
      list.forEach((word, idx)=>{
        const chip = document.createElement('button');
        chip.type = 'button'; chip.className = 'so-chip'; chip.setAttribute('data-word', word);
        chip.innerHTML = `<span class="txt">${word}</span>` + (deletable? `<span class="del" data-index="${idx}" aria-label="삭제">×</span>`:'');
        container.appendChild(chip);
      });
    }

    function openOverlay(){
      overlay.setAttribute('aria-hidden','false');
      const wrap = input.closest('.search-wrap') || input.parentElement;
      if (wrap) { const rect = wrap.getBoundingClientRect(); overlay.style.width = rect.width + 'px'; }
    }
    function closeOverlay(){
      overlay.setAttribute('aria-hidden','true');
      overlay.querySelectorAll('.kb-focus').forEach(el=>el.classList.remove('kb-focus'));
    }

    renderChips(popular, popularEl, {deletable:false});
    renderChips(getRecent(), recentEl, {deletable:true});

    input.addEventListener('focus', ()=>{ suppressBrowserSuggestions(input); openOverlay(); });
    input.addEventListener('input', openOverlay);
    document.addEventListener('click', (e)=>{ if(!(overlay.contains(e.target)||input.contains(e.target))) closeOverlay(); });

    document.addEventListener('click', (e)=>{
      const chip = e.target.closest('.so-chip'); if(!chip) return;
      const word = chip.dataset.word;
      if(e.target.closest('.del')){
        const idx = +e.target.dataset.index; const arr = getRecent(); arr.splice(idx,1); setRecent(arr);
        renderChips(getRecent(), recentEl, {deletable:true}); return;
      }
      const arr = getRecent().filter(w=>w!==word); arr.unshift(word); setRecent(arr);
      renderChips(getRecent(), recentEl, {deletable:true});
      location.href = `/community/?tab=board&q=${encodeURIComponent(word)}`;
    });

    clearRecentBtn?.addEventListener('click', ()=>{ localStorage.removeItem(LS_KEY); renderChips([], recentEl, {deletable:true}); });
  })();

  // Width sync for footer viewport
  function navSpanWidth(){
    const catWrap  = document.querySelector('.bar-lg .category-trigger');
    const iconRow  = document.querySelector('.bar-lg .icon-row');
    if(!catWrap || !iconRow) return null;
    const leftEdge = catWrap.getBoundingClientRect().left;
    const rightEdge= iconRow.getBoundingClientRect().right;
    return Math.max(0, rightEdge - leftEdge);
  }
  function applySpanWidthTo(idList){
    const span = navSpanWidth();
    idList.forEach(id=>{
      const el=document.getElementById(id);
      if(!el) return;
      if (window.innerWidth >= 992 && span!=null){
        el.style.width = span + 'px'; el.style.marginLeft = 'auto'; el.style.marginRight = 'auto';
      }else{ el.style.width = ''; el.style.marginLeft = ''; el.style.marginRight = ''; }
    });
  }
  function syncAllWritePage(){
    applySpanWidthTo(['ftViewport']);
  }
  window.addEventListener('load', syncAllWritePage);
  window.addEventListener('resize', syncAllWritePage);
  if(document.fonts?.ready) document.fonts.ready.then(syncAllWritePage);
})();
</script><script>
// === Photo uploader (max 5) ===
(function(){
  const thumbInput=document.getElementById('thumbInput');
  const thumbGrid=document.getElementById('thumbGrid');
  const MAX_PHOTOS=5;
  function addPreview(file){
    const url=URL.createObjectURL(file);
    const tile=document.createElement('div');
    tile.className='thumb-tile preview';
    tile.innerHTML=`<img alt="preview"><button class="del" type="button" aria-label="삭제"><i class="bi bi-x"></i></button>`;
    tile.querySelector('img').src=url;
    tile.querySelector('.del').addEventListener('click',()=> tile.remove());
    thumbGrid.appendChild(tile);
  }
  if(thumbInput && thumbGrid){
    thumbInput.addEventListener('change', (e)=>{
      const files=[...e.target.files].slice(0, MAX_PHOTOS);
      files.forEach(addPreview);
      thumbInput.value='';
    });
    const addLabel = thumbGrid.querySelector('.thumb-tile');
    if(addLabel){ addLabel.addEventListener('click', ()=> thumbInput.click()); }
  }
})();
</script><script>
// === 검색 오버레이 토글 ===
(function(){
  const search = document.getElementById('globalSearch');
  const overlay = document.getElementById('searchOverlay');
  if (search && overlay){
    search.addEventListener('focus', ()=> overlay.setAttribute('aria-hidden','false'));
    document.addEventListener('click', (e)=>{
      if(!overlay.contains(e.target) && e.target!==search){
        overlay.setAttribute('aria-hidden','true');
      }
    });
  }
  const searchSm = document.getElementById('globalSearchSm');
  // (모바일은 접힘 메뉴 안이므로 기본 동작 유지)
})();
</script><script>
  // === Photo uploader (max 5) ===
  (function(){
    const thumbInput=document.getElementById('thumbInput');
    const thumbGrid=document.getElementById('thumbGrid');
    const MAX_PHOTOS=5;
    function addPreview(file){
      const url=URL.createObjectURL(file);
      const tile=document.createElement('div');
      tile.className='thumb-tile preview';
      tile.innerHTML=`<img alt="preview"><button class="del" type="button" aria-label="삭제"><i class="bi bi-x"></i></button>`;
      tile.querySelector('img').src=url;
      tile.querySelector('.del').addEventListener('click',()=> tile.remove());
      thumbGrid.appendChild(tile);
    }
    if(thumbInput && thumbGrid){
      thumbInput.addEventListener('change', (e)=>{
        const files=[...e.target.files].slice(0, MAX_PHOTOS);
        files.forEach(addPreview);
        thumbInput.value='';
      });
      const addLabel = thumbGrid.querySelector('.thumb-tile');
      if(addLabel){ addLabel.addEventListener('click', ()=> thumbInput.click()); }
    }
  })();
</script>
<script>
(() => {
  // Simple counters
  const titleEl=document.getElementById('title');
  const contentEl=document.getElementById('content');
  const titleCnt=document.getElementById('titleCnt');
  const bodyCnt=document.getElementById('bodyCnt');
  const update=()=>{ titleCnt.textContent=titleEl.value.length; bodyCnt.textContent=contentEl.value.length; };
  ['input','change'].forEach(ev=>{ titleEl.addEventListener(ev,update); contentEl.addEventListener(ev,update); }); update();

  const form=document.getElementById('boardWriteForm');
  const toast=(msg)=>{ const t=document.getElementById('toast'); t.textContent=msg; t.style.opacity='1'; t.style.transform='translateY(0)'; setTimeout(()=>{ t.style.opacity='0'; t.style.transform='translateY(10px)'; }, 1500); };
  form.addEventListener('submit', (e)=>{ e.preventDefault(); if(!form.checkValidity()){ toast('필수 항목을 확인하세요'); return; } toast('등록되었습니다'); });

  // Width sync for footer
  function navSpanWidth(){
    const catWrap  = document.querySelector('.bar-lg .category-trigger');
    const iconRow  = document.querySelector('.bar-lg .icon-row');
    if(!catWrap || !iconRow) return null;
    const leftEdge = catWrap.getBoundingClientRect().left;
    const rightEdge= iconRow.getBoundingClientRect().right;
    return Math.max(0, rightEdge - leftEdge);
  }
  function applySpanWidthTo(idList){
    const span = navSpanWidth();
    idList.forEach(id=>{
      const el=document.getElementById(id);
      if(!el) return;
      if (window.innerWidth >= 992 && span!=null){
        el.style.width = span + 'px';
        el.style.marginLeft = 'auto';
        el.style.marginRight = 'auto';
      }else{
        el.style.width = '';
        el.style.marginLeft = '';
        el.style.marginRight = '';
      }
    });
  }
  const sync=()=>applySpanWidthTo(['ftViewport']);
  addEventListener('load', sync); addEventListener('resize', sync); if(document.fonts?.ready) document.fonts.ready.then(sync);
})();
</script>
<script>
// === 내가 한 것 선택 -> 카테고리/지역 자동 채움 ===
(function(){
  const myActivity=document.getElementById('myActivity');
  const category=document.getElementById('category');
  const region=document.getElementById('region');
  if(myActivity && category && region){
    myActivity.addEventListener('change', ()=>{
      const opt=myActivity.options[myActivity.selectedIndex];
      const cat=opt.getAttribute('data-category')||'';
      const reg=opt.getAttribute('data-region')||'';
      if(cat){ category.value=cat; }
      if(reg){ region.value=reg; }
    });
  }
})();
</script></body>
</html>
