<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>후기 상세 | HOBBY</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
<style>
  /* ===== 공통 ===== */
  :root{
    /* 포인트/파스텔 */
    --info:#98A7AC;          /* 링크 hover 등 */
    --muted-bg:#AAD9CD;      /* hover: 민트 파스텔 */
    --primary:#E2B8AC;
    --primary-strong:#C79A8C;
    --line:#eceef2; --ink:#111; --muted:#6b7280;
    --rail: 920px;
  }
  body{
    font-family:
      'Noto Sans KR',
      'Apple SD Gothic Neo',
      'Malgun Gothic',
      'Segoe UI', Roboto, Arial, sans-serif;
  }
  .top-banner{ background:#f8f9fa; font-size:.9rem; border-bottom:1px solid #eee; }
  .top-banner a{ color:#333; text-decoration:none; margin-left:15px; }

  /* 로고(HOBBY) — 유지 */
  .navbar-brand{
    font-weight:700;
    color:#111 !important;
    font-size:2rem;
    font-family:'Poppins', sans-serif;
  }

  .divider{ width:1px; height:24px; background:#ddd; margin:0 12px; }
  .hero-wrap{ background:#fff; border-bottom:1px solid rgba(0,0,0,.04); }

  /* ===== 배너 영역 ===== */
  .hero-wrap .carousel-viewport{
    height:120px;
    border-radius:16px;
    border:none;
    overflow:hidden;
    background:#fff;
    position:relative;
    margin-left:auto; margin-right:auto; /* 중앙 정렬 */
  }
  @media (max-width:576.98px){
    .hero-wrap .carousel-viewport{ height:100px; }
  }
  .hero-wrap .carousel-inner{ height:100%; }
  .hero-wrap .carousel-item{ height:100%; }

  .hero-wrap .banner-box{
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    width:100%;
    position:relative;
  }
  /* 배너 이미지를 '가득 채우기' */
  .hero-wrap .banner-img{
    width:100% !important;
    height:100% !important;
    object-fit:cover !important;
    object-position:center;
    display:block;
    transition:all .3s ease;
  }

  .carousel-control-prev, .carousel-control-next{ width:42px; }
  .carousel-indicators [data-bs-target]{ width:8px; height:8px; border-radius:50%; }

  /* ===== 화살표 오버레이 ===== */
  .controls-overlay{
    position:absolute; inset:0; z-index:20; pointer-events:none;
  }
  .controls-overlay .carousel-control-prev,
  .controls-overlay .carousel-control-next{
    position:absolute; top:50%; transform:translateY(-50%);
    width:44px!important; height:44px; background:transparent;
    pointer-events:auto; border:0;
  }
  .controls-overlay .carousel-control-prev-icon,
  .controls-overlay .carousel-control-next-icon{
    background-size:100% 100%;
    filter: drop-shadow(0 1px 2px rgba(0,0,0,.75));
  }

  /* 배너와 헤더 간격 */
  section.hero-wrap{ padding-top:1rem!important; padding-bottom:1rem!important; }

  /* ===== 헤더/카테고리 — 유지 ===== */
  @media (min-width:992px){ .bar-lg{display:flex!important} .bar-sm{display:none!important} }
  @media (max-width:991.98px){ .bar-lg{display:none!important} .bar-sm{display:flex!important} }
  .search-wrap{ position:relative; flex:1; max-width:480px; }
  .search-bar{ width:100%; border-radius:50px; transition:background .12s, border-color .12s; }
  .search-bar:hover,
  .search-bar:focus{
    box-shadow:none;
  }
  .icon-row{ display:flex; align-items:center; gap:16px; }
  .nav-icon{ position:relative; margin:0 6px; cursor:pointer; }
  .nav-icon span{
    position:absolute; bottom:-22px; left:50%; transform:translateX(-50%);
    background:#333; color:#fff; padding:2px 6px; border-radius:4px; font-size:12px;
    white-space:nowrap; opacity:0; transition:opacity .15s;
  }
  .nav-icon:hover span{ opacity:1; }

  .category-trigger{ position:relative; }
  .mega-panel{
    position:absolute; top:100%; left:50%; transform:translateX(-50%);
    width:auto; max-width:calc(100vw - 32px);
    margin-top:10px; padding:10px;
    background:#fff; border:1px solid #e5e7eb; border-radius:14px;
    box-shadow:0 16px 36px rgba(0,0,0,.08);
    display:none; z-index:2000;
  }
  .category-trigger-sm{ position:relative; }
  .mega-panel.mobile{
    position:absolute; top:calc(100% + 8px); left:0; transform:none; margin-top:0;
    width:max(260px, min(640px, 92vw)); max-width:92vw; padding:10px;
  }

  :root{
    --chip-h: 44px; --chip-pad-x: 10px; --chip-radius: 10px;
    --chip-fs: 13px; --chip-weight: 500;
    --chip-border: #dfe3e7; --chip-border-hover:#d4d8dd;
    --chip-bg:#fff; --chip-bg-hover:#fafafa;
    --badge-size: 22px; --badge-fs: 14px;
    --chip-col-w: 160px; --chip-gap-x: 6px; --chip-gap-y: 6px;
  }
  .mega-grid{
    display:grid; grid-template-columns:repeat(3, var(--chip-col-w));
    gap:var(--chip-gap-y) var(--chip-gap-x); justify-content:center;
  }
  .cat-chip{
    height:var(--chip-h); border:1px solid var(--chip-border); background:var(--chip-bg);
    border-radius:var(--chip-radius); display:flex; align-items:center; gap:8px;
    padding:0 var(--chip-pad-x); width:100%; box-sizing:border-box; cursor:pointer;
    transition:background-color .12s, border-color .12s, color .12s;
    justify-content:center; color:#4b5563;
  }
  /* ✅ 카테고리 칩 Hover → 민트 파스텔 */
  .cat-chip:hover{
    background: color-mix(in srgb, var(--muted-bg) 22%, white);
    border-color: var(--chip-border-hover);
    color:#333;
  }
  /* (요청) 활성 색상 제거: .cat-chip.active 스타일 없음 */

  .cat-title{ font-size:var(--chip-fs); font-weight:var(--chip-weight); color:inherit; letter-spacing:-.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; line-height:1; }
  .chip-badge{
    width:var(--badge-size); height:var(--badge-size); border-radius:8px; display:grid; place-items:center; font-size:var(--badge-fs);
    background:#f6f7f8; border:1px solid #eceff2; color:#374151; flex:0 0 auto;
    transition:background-color .12s, border-color .12s, color .12s;
  }

  /* 이모지 깨짐 방지 */
  .chip-badge, .cat-title{
    font-family:
      inherit,
      'Apple Color Emoji',
      'Segoe UI Emoji',
      'Noto Color Emoji';
  }

  /* ======= 베스트 크루 전용 스타일 ======= */
  .best-crew-wrap{ background:#fff; margin-top:18px; }
  .bc-header{
    display:flex; align-items:center; justify-content:space-between;
    gap:12px; margin-bottom:10px;
  }
  .bc-title{ font-weight:700; font-size:1.35rem; letter-spacing:-.2px; }
  .bc-more{ text-decoration:none; color:#6b7280; font-size:.9rem; }

  .bc-viewport{ width:100%; }

  .bc-grid .crew-card{
    border:1px solid #eceef2; border-radius:14px; overflow:hidden; background:#fff;
    transition:transform .12s ease, box-shadow .12s ease;
    position:relative; /* stretched-link용 - 추가 */
  }
  .bc-grid .crew-card:hover{
    transform:translateY(-2px);
    box-shadow:0 8px 20px rgba(0,0,0,.05);
  }
  .crew-thumb{ position:relative; aspect-ratio: 16/9; background:#f8f9fb; }
  .crew-thumb img{
    position:absolute; inset:0; width:100%; height:100%;
    object-fit:cover; object-position:center;
  }
  .bc-like{
    position:absolute; left:10px; bottom:10px;
    width:34px; height:34px; border-radius:50%;
    background:#ffffff; border:1px solid rgba(0,0,0,.08);
    display:grid; place-items:center; cursor:pointer;
    transition:transform .12s ease, box-shadow .12s ease;
       z-index:3;
  }
  .bc-like .bi{ font-size:1rem; }
  .bc-like:hover{ transform:scale(1.04); box-shadow:0 6px 12px rgba(0,0,0,.1); }
  .bc-like .bi-heart-fill{ display:none; }
  .bc-like.active .bi-heart{ display:none; }
  .bc-like.active .bi-heart-fill{ display:inline-block; color:#ef4444; }

  .crew-body{ padding:10px 12px 12px; }
  .crew-meta{ color:#6b7280; font-size:.9rem; }
  .crew-title{ margin:4px 0 6px; font-weight:600; font-size:1rem; color:#111; line-height:1.25; }
  .crew-time{ color:#6b7280; display:flex; align-items:center; gap:6px; font-size:.9rem; }
  .crew-time .bi{ font-size:.95rem; }

  /* ===== 모바일 2열 ===== */
  @media (max-width:576.98px){
    .bc-grid > [class*="col-"]{
      max-width: 50%;
      flex: 0 0 50%;
      margin-left: 0;
      margin-right: 0;
    }
    .crew-title{ font-size:.95rem; }
    .crew-meta, .crew-time{ font-size:.85rem; }
    .bc-header{ padding:0 6px; }
  }

  /* ===== 커뮤니티 ===== */
  .community-wrap{ background:#fff; margin-top:18px; }
  .cm-title{ font-weight:700; font-size:1.35rem; letter-spacing:-.2px; }
  .cm-more{ text-decoration:none; color:#6b7280; font-size:.9rem; }

  /* 상단 탭 */
  .cm-top{
    display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px;
  }
  .cm-tabs{ display:flex; gap:8px; align-items:center; }
  .cm-tab{
    border:none; background:transparent; color:#374151;
    padding:6px 10px; border-radius:10px; font-size:.95rem; line-height:1; cursor:pointer;
    transition:color .12s ease, background-color .12s ease;
  }
  .cm-tab.active{
    color:#111;
    background:#f5f6f8;
    font-weight:600;
  }

  /* 컨텐츠 래퍼 높이 고정(전환 시 세로길이 유지) */
  #cmContent{ position:relative; }
  #cmContent > .tab-pane{ transition:opacity .12s ease; }
  #cmContent > .tab-pane.hidden{ opacity:0; pointer-events:none; position:absolute; inset:0; }

  /* 후기 카드 */
  .feed-card{
    border:1px solid #eceef2; border-radius:14px; overflow:hidden; background:#fff;
    transition:transform .12s ease, box-shadow .12s ease;
  }
  .feed-card:hover{ transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.05); }
  .feed-thumb{ position:relative; aspect-ratio: 16/9; background:#f8f9fb; }
  .feed-thumb img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; object-position:center; }
  .feed-body{ padding:12px; }
  .feed-meta{ color:#6b7280; font-size:.9rem; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .feed-title{ margin:6px 0 6px; font-weight:600; font-size:1rem; color:#111; line-height:1.3; }
  .feed-text{ color:#374151; font-size:.95rem; }
  .feed-reviewer{ color:#6b7280; font-size:.9rem; }

  /* 자유게시판: 일자형 리스트 */
  .board-grid{ row-gap:10px; }
  .board-row{
    border:1px solid #eceef2; border-radius:12px; background:#fff;
    padding:10px 12px; height:100%;
    display:flex; flex-direction:column; justify-content:center;
    position:relative;
  }
  .board-title{ margin:0; font-weight:600; color:#111; font-size:0.98rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .board-excerpt{ margin:4px 0 0; color:#4b5563; font-size:0.95rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .board-meta{ margin-top:4px; font-size:.83rem; color:#6b7280; }
  .stretched-link{ position:static; }

  /* 자유게시판: 화면 줄이면 2개씩 */
  @media (min-width:992px){
    .board-col{ flex:0 0 100%; max-width:100%; }
  }
  @media (max-width:991.98px){
    .board-col{ flex:0 0 50%; max-width:50%; }
  }

  /* ====== 푸터(Instagram Box – Light) ====== */
  :root{
    --line:#f0f0f0;
    --ink:#555;
    --muted:#888;
    --bg:#fff;
    --card:#f8f8f8;
    --ft-maxw:1080px;
  }
  .footer-wrap{ background:#fff; margin-top:18px; }
  .footer-viewport{ width:100%; }
  .footer-box{
    margin:24px 0 40px;
    background:var(--card);
    border:1px solid var(--line);
    border-radius:12px;
    padding:20px;
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:16px;
    max-width:var(--ft-maxw);
    margin-left:auto; margin-right:auto;
    color:var(--ink);
  }
  .footer-box .ft-title{
    font-weight:600;
    margin-bottom:6px;
    display:flex;align-items:center;gap:6px;
    color:#444;
    font-size:15px;
    text-transform:lowercase;
  }
  .footer-box a{
    display:block;
    color:var(--muted);
    text-decoration:none;
    margin:4px 0;
    font-size:14px;
    transition:color 0.2s ease;
  }
  .footer-box a:hover{ color:#555; text-decoration:underline; }
  .footer-box .ft-title i.fa-instagram{ color:#E4405F; opacity:0.8; }
  a:focus-visible{outline:2px solid #aaa;outline-offset:2px}

  /* ===== Search Overlay (인기/최근 검색어) ===== */
  .search-overlay{
    position:absolute; left:0; right:0; top:calc(100% + 8px);
    background:#fff; border:1px solid #eceef2; border-radius:12px;
    padding:12px; z-index:2050; display:none;
    box-shadow:0 8px 24px rgba(0,0,0,.08);
  }
  .search-overlay[aria-hidden="false"]{ display:block; }
  .so-section + .so-section{ margin-top:10px; }
  .so-title{ font-weight:600; font-size:.95rem; color:#374151; margin-bottom:6px; }
  .so-row{ display:flex; align-items:center; gap:8px; }
  .so-chips{ display:flex; flex-wrap:wrap; gap:8px; }
  .so-chip{
    display:inline-flex; align-items:center; gap:6px;
    padding:6px 10px; background:#fff; border:1px solid #e5e7eb;
    border-radius:999px; font-size:.92rem; color:#374151; cursor:pointer;
    transition:background .12s, border-color .12s, color .12s;
  }
  /* ✅ 검색 칩 Hover → 민트 파스텔 */
  .so-chip:hover{
    background: color-mix(in srgb, var(--muted-bg) 35%, white);
    border-color: #d7dde3;
    color:#333;
  }
  /* (요청) 검색 칩 활성 색상 제거: .so-chip.active 스타일 없음 */

  .so-chip .del{
    display:inline-grid; place-items:center; width:18px; height:18px;
    border-radius:50%; border:1px solid #e5e7eb; font-size:12px; line-height:1;
    background:#fff; cursor:pointer;
  }
  .so-chip .del:hover{ background:#fafafa; }
  .so-chip.kb-focus{ outline:2px solid #98A7AC; outline-offset:2px; }
  .so-clear-all{ font-size:.85rem; color:#6b7280; }
  .so-clear-all:hover{ color:#374151; text-decoration:underline; }

  /* === Community tabs: match community.html look === */
  .cm-tabs .cm-tab{
    border:0; background:#fff; color:#374151;
    border-radius:10px; padding:8px 14px; font-size:.98rem; line-height:1;
  }
  .cm-tabs .cm-tab:hover{
    background: color-mix(in srgb, var(--surface, #CDDAD8) 30%, white);
  }
  .cm-tabs .cm-tab.active{
    color: var(--primary-strong);
    background: color-mix(in srgb, var(--surface, #CDDAD8) 55%, white);
    font-weight:700;
  }

  /* ===== 자유게시판(community.html 스타일 매칭) ===== */
  .board-list{ border:1px solid #eceef2; border-radius:14px; overflow:hidden; background:#fff; }
  .board-item{ display:flex; gap:12px; padding:14px 16px; align-items:center; border-top:1px solid #f1f2f6; }
  .board-item:first-child{ border-top:0; }
  .board-thumb{ flex:0 0 60px; height:60px; border-radius:10px; overflow:hidden; background:#f0f2f4; }
  .board-thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
  .board-title{ margin:0; font-weight:600; color:#111; }
  .board-excerpt{ color:#374151; margin:.25rem 0 .35rem; }
  .board-meta{ color:#6b7280; font-size:.9rem; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .badge-photo{ border:1px solid #e5e7eb; background:#fff; color:#374151; border-radius:999px; padding:2px 8px; font-size:.8rem; }

  /* ===== 자유게시판(community.html 스타일 동일) ===== */
  .board-list{ border:1px solid #eceef2; border-radius:14px; overflow:hidden; background:#fff; }
  .board-item{ display:flex; gap:12px; padding:14px 16px; align-items:center; border-top:1px solid #f1f2f6; }
  .board-item:first-child{ border-top:0; }
  .board-thumb{ flex:0 0 60px; height:60px; border-radius:10px; overflow:hidden; background:#f0f2f4; }
  .board-thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
  .board-title{ margin:0; font-weight:600; color:#111; }
  .board-excerpt{ color:#374151; margin:.25rem 0 .35rem; }
  .board-meta{ color:#6b7280; font-size:.9rem; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .badge-photo{ border:1px solid #e5e7eb; background:#fff; color:#374151; border-radius:999px; padding:2px 8px; font-size:.8rem; }

  /* ✅ (요청) 자유게시판 제목 링크를 항상 검정색으로 고정 */
  .board-title a,
  .board-title a:visited,
  .board-title a:hover{
    color:#000 !important;
    text-decoration:none;
  }

  /* ===== Detail page extras ===== */
  body{ color:var(--ink); background:#fff; }
  .rail{ max-width: var(--rail); width: min(var(--rail), 100% - 32px); margin: 0 auto; }
  @media (max-width:991.98px){ .rail{ max-width:none; width:auto; padding:0 16px; }}

  /* ★ 여기부터: 페이지 헤더/브레드크럼을 두 번째 예시와 동일하게 */
  .page-header{ padding:20px 0 8px; border-bottom:1px solid rgba(0,0,0,.04); }
  .page-title{ font-size:1.5rem; font-weight:700; letter-spacing:-.2px; } /* ← 1.5rem로 통일 */
  .breadcrumb .breadcrumb-item > a{ color: var(--info); text-decoration:none; }
  .breadcrumb .breadcrumb-item > a:hover{ text-decoration:underline; }
  .breadcrumb .breadcrumb-item.active{ color: var(--primary-strong); font-weight:700; }
  /* ★ 끝 */

  .detail-grid{ display:grid; grid-template-columns: 1fr; gap:20px; } /* 한 칼럼 유지 */
  .hero{ position:relative; aspect-ratio: 4/3; background:#f0f2f4; border-radius:14px; overflow:hidden; }
  .hero img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; object-position:center; }
  .title{ margin:10px 0 4px; font-weight:800; font-size:1.5rem; letter-spacing:-.2px; }
  .detail-head{ display:flex; align-items:center; gap:12px; }
  .avatar{ width:42px; height:42px; border-radius:50%; overflow:hidden; background:#f2f3f5; flex:0 0 42px; }
  .avatar img{ width:100%; height:100%; object-fit:cover; object-position:center; display:block; }
  .meta{ color:var(--muted); font-size:.92rem; }
  .rating{ color:#f59e0b; display:inline-flex; align-items:center; gap:4px; font-weight:600; }

  .chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
  /* ▶ 추가: 라인 우측 배치용 - margin 제거 */
  .chips-inline{ margin-top:0; }

  .chip{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; background:#fff; border:1px solid var(--line);
    border-radius:999px; font-size:.92rem; color:#374151; text-decoration:none; transition:background .12s, border-color .12s, color .12s; }
  .chip:hover{
    background: color-mix(in srgb, var(--muted-bg) 35%, white);
    border-color:#d7dde3;
    color:#333;
  }

  .detail-body{ margin-top:12px; font-size:1rem; line-height:1.7; color:#374151; white-space:pre-line; }
  .detail-body.collapsed{ display:-webkit-box; -webkit-line-clamp:10; -webkit-box-orient:vertical; overflow:hidden; }
  .moreless{ display:none; color:#6b7280; font-size:.95rem; text-decoration:none; }
  .moreless:hover{ text-decoration:underline; }

  /* Actions */
  .actions{ display:flex; align-items:center; justify-content:space-between; padding:10px 0 0; font-size:.95rem; color:#000; flex-wrap:wrap; gap:8px; }
  .act-left{ display:flex; align-items:center; gap:16px; }
  .act-right{ display:flex; align-items:center; gap:10px; }
  .act{ display:inline-flex; align-items:center; gap:6px; cursor:pointer; user-select:none; color:#000; text-decoration:none; }
  .act .num{ min-width:1.2em; text-align:left; }
  .like-btn .bi-heart-fill{ display:none; }
  .like-btn.active .bi-heart{ display:none; }
  .like-btn.active .bi-heart-fill{ display:inline-block; color:#dc3545; }

  .detail-foot{ display:flex; gap:8px; justify-content:flex-end; margin-top:10px; }
  .detail-foot .btn{ border-radius:10px; }

  /* ===== 댓글 (아래 배치) ===== */
  .cmt-wrap{ border:1px solid var(--line); border-radius:12px; overflow:hidden; background:#fff; margin-top:16px; }
  .cmt-head{ background:#fafafa; padding:10px 12px; font-weight:600; color:#374151; display:flex; align-items:center; justify-content:space-between; }
  .cmt-head .count{ color:#6b7280; font-weight:600; }
  .cmt-row{ display:flex; gap:10px; padding:12px; border-top:1px solid #f1f2f6; }
  .cmt-row:first-child{ border-top:0; }
  .cmt-author-line{ display:flex; align-items:center; gap:8px; }
  .cmt-author{ font-weight:600; color:#111; }
  .cmt-meta{ color:#6b7280; font-size:.85rem; }
  .cmt-text{ margin:2px 0 0; color:#374151; white-space:pre-line; }
  .cmt-del{ margin-top:auto; padding:0; background:none; border:0; color:#6b7280; font-size:.85rem; cursor:pointer; align-self:flex-end; }
  .cmt-del:hover{ text-decoration:underline; }
  .cmt-form{ display:flex; gap:8px; padding:12px; border-top:1px solid #f1f2f6; background:#fff; }
  .cmt-form textarea{ resize:vertical; min-height:64px; }
  .cmt-form textarea:focus{ box-shadow:none !important; outline:none !important; border-color:#d7dde3 !important; }

  /* Copy toast */
  .toast-lite{ position:fixed; right:20px; bottom:20px; z-index:3000; background:#fff; color:#2b2f31; border:1px solid #dfe3e7;
    border-radius:12px; padding:12px 14px; box-shadow:0 10px 24px rgba(0,0,0,.08);
    display:flex; align-items:center; gap:10px; transform: translateY(20px); opacity:0; pointer-events:none;
    transition: transform .18s ease, opacity .18s ease; }
  .toast-lite.show{ transform: translateY(0); opacity:1; pointer-events:auto; }
  .toast-lite .btn{ border-radius:10px; padding:6px 10px; font-weight:700; }
  .toast-lite .btn-copy-ok{ background:#fff; border:1px solid #dfe3e7; color:#333; }
  .toast-lite .btn-close-lite{ background:transparent; border:0; color:#555; }

  /* desktop: hide mini banner (links live in navbar) */
  @media (min-width:992px){ .top-banner{ display:none !important; } }

  /* desktop auth-links (회원가입/로그인/공지사항) */
  .auth-links{ gap:4px; }
  .auth-links .auth-link{ text-decoration:none; font-size:.95rem; color:#374151; padding:0 6px; }
  .auth-links .auth-link:hover{ text-decoration:underline; }
  .auth-links .auth-div{ color:#c9ccd2; }/* comment form single-line */
  .cmt-form{ flex-wrap:nowrap; align-items:stretch; }
  .cmt-form textarea{ flex:1 1 auto; min-width:0; }
  .cmt-form .btn{ display:flex; align-items:center; justify-content:center;  flex:0 0 auto; white-space:nowrap; align-self:stretch; }

  /* page-title color enforce */
  .page-header .page-title{ color:#000 !important; }
</style>
</head>
<body>
<div class="top-banner text-end py-1 px-3">
    <a href="#">회원가입</a><a href="#">로그인</a><a href="/community/?tab=notice">공지사항</a>
  </div>

  <nav class="navbar bg-white border-bottom sticky-top bar-lg">
    <div class="container d-flex justify-content-center">
      <div class="d-flex align-items-center justify-content-center gap-3 w-100 flex-wrap">
        <div class="category-trigger">
          <button id="btnCatDesk" class="btn btn-link text-dark fs-4" data-bs-toggle="tooltip" data-bs-placement="bottom" title="카테고리" aria-expanded="false">
            <i class="bi bi-grid"></i>
          </button>
          <div id="panelDesk" class="mega-panel" role="menu" aria-label="카테고리">
            <div id="gridDesk" class="mega-grid"></div>
          </div>
        </div>
        <div class="divider"></div>
        <a class="navbar-brand" href="#">HOBBY</a>

        <!-- 검색 오버레이/자동완성 차단 -->
        <form class="d-flex search-wrap" autocomplete="off">
          <input type="text" style="position:absolute; left:-9999px; top:-9999px; height:0; width:0; opacity:0;" aria-hidden="true" tabindex="-1">
          <input
            id="globalSearch"
            class="form-control search-bar"
            type="search"
            placeholder="지금 생각나는 취미를 검색하세요"
            aria-label="Search"
            name="hobby_search"
            autocomplete="off"
            autocapitalize="off"
            autocorrect="off"
            spellcheck="false"
            enterkeyhint="search"
            inputmode="search"
          >
          <!-- ▼ 검색 오버레이 -->
          <div id="searchOverlay" class="search-overlay shadow-sm" role="dialog" aria-label="검색 제안" aria-hidden="true">
            <div class="so-section">
              <div class="so-title">인기 검색어</div>
              <div class="so-chips" id="popularChips"></div>
            </div>
            <div class="so-section">
              <div class="so-row">
                <div class="so-title mb-0">최근 검색어</div>
                <button class="btn btn-sm btn-link p-0 ms-auto so-clear-all" type="button" id="clearRecent" aria-label="최근 검색어 모두 삭제">전체삭제</button>
              </div>
              <div class="so-chips" id="recentChips"></div>
            </div>
          </div>
          <!-- ▲ 검색 오버레이 끝 -->
        </form>

        
        
        <div class="icon-row">
          <div class="nav-icon"><i class="bi bi-people fs-4"></i><span>크루</span></div>
          <div class="nav-icon"><i class="bi bi-bell fs-4"></i><span>알림</span></div>
          <div class="nav-icon"><i class="bi bi-heart fs-4"></i><span>찜</span></div>
          <div class="nav-icon"><i class="bi bi-person fs-4"></i><span>마이</span></div>
          
          <div class="auth-links d-none d-lg-flex align-items-center ms-2">
            <a class="auth-link" href="/accounts/signup/">회원가입</a>
            <span class="auth-div">|</span>
            <a class="auth-link" href="/accounts/login/">로그인</a>
            <span class="auth-div">|</span>
            <a class="auth-link" href="/community/?tab=notice">공지사항</a>
          </div>
        </div>
</nav>
<nav class="navbar bg-white border-bottom sticky-top bar-sm w-100" id="mobileBar">
    <div class="container-fluid d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        <div class="category-trigger-sm">
          <button id="btnCatM" class="btn btn-link text-dark fs-4 me-1" data-bs-toggle="tooltip" data-bs-placement="bottom" title="카테고리" aria-expanded="false">
            <i class="bi bi-grid"></i>
          </button>
          <div id="panelM" class="mega-panel mobile" role="menu" aria-label="카테고리 (모바일)">
            <div id="gridM" class="mega-grid"></div>
          </div>
        </div>
        <a class="navbar-brand ms-1" href="#">HOBBY</a>
      </div>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenuSm" aria-controls="navMenuSm" aria-expanded="false">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse bg-white" id="navMenuSm">
      <div class="p-3 border-bottom">
        <div class="input-group" autocomplete="off">
          <input type="text" style="position:absolute; left:-9999px; top:-9999px; height:0; width:0; opacity:0;" aria-hidden="true" tabindex="-1">
          <input
            id="globalSearchSm"
            type="search"
            class="form-control"
            placeholder="취미 검색…"
            aria-label="Search"
            name="hobby_search_sm"
            autocomplete="off"
            autocapitalize="off"
            autocorrect="off"
            spellcheck="false"
            enterkeyhint="search"
            inputmode="search"
          >
          <button class="btn btn-outline-secondary" type="button"><i class="bi bi-search"></i></button>
        </div>
      </div>
      <ul class="navbar-nav p-2 gap-1">
        <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-people me-2"></i>크루</a></li>
        <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-bell me-2"></i>알림</a></li>
        <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-heart me-2"></i>찜</a></li>
        <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-person me-2"></i>마이</a></li>
      </ul>
    </div>
  </nav>

  <header class="page-header">
  <div class="container"><div class="rail">
    <div class="d-flex align-items-center justify-content-between">
      <div class="page-title">커뮤니티</div>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-0">
          <li class="breadcrumb-item"><a href="/">Home</a></li>
          <li class="breadcrumb-item"><a href="/community/?tab=reviews">커뮤니티</a></li>
          <li class="breadcrumb-item active" aria-current="page">후기</li>
        </ol>
      </nav>
    </div>
  </div></div>
</header>

<main class="py-3">
  <div class="container"><div class="rail">
    <div class="detail-grid">
      <!-- 본문 -->
      <section>
        <h1 class="title">기초부터 향 테이스팅까지 알차게 배웠어요</h1>

        <!-- ▶ chips를 라인 오른쪽 끝으로 이동 -->
        <div class="detail-head mb-2">
          <span class="avatar"><img src="https://i.pravatar.cc/80?img=5" alt="작성자"></span>
          <div>
            <div class="meta"><span class="me-2">김수안</span>· <span class="me-2">2025-08-15</span>· <span id="metaViews">조회 123</span></div>
            <div class="rating" aria-label="별점 4.0">
              <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star"></i>
              <span class="ms-1">4.0</span>
            </div>
          </div>
          <div class="chips chips-inline ms-auto" role="list">
            <a class="chip" href="/community/?tab=reviews&area=성수">성수</a>
            <a class="chip" href="/community/?tab=reviews&cat=와인클래스">와인클래스</a>
          </div>
        </div>

        <div class="hero mt-2">
          <img src="https://images.unsplash.com/photo-1506059612708-99d6c258160e?q=80&w=1600&auto=format&fit=crop" alt="와인 테이스팅 클래스">
        </div>

        <div id="detailBody" class="detail-body collapsed">
와인의 기본 지식부터 잔에 따른 향 변화까지! 초보자도 쉽게 따라올 수 있도록 설명해주셨어요. 클래스가 깔끔하게 구성되어 집중하기 좋았고, 다양한 품종을 직접 시향/시음하며 이해도를 높일 수 있었습니다. 다음엔 치즈 페어링 수업도 참여해보고 싶어요. :)
        </div>
        <a id="btnMoreLess" class="moreless mt-1" href="#" role="button" aria-expanded="false">더보기</a>

        <!-- 액션 라인 -->
        <div class="actions" id="actions">
          <div class="act-left">
            <span id="likeBtn" class="act like-btn" role="button" aria-pressed="false">
              <i class="bi bi-heart"></i><i class="bi bi-heart-fill"></i><span class="num" id="likeNum">0</span>
            </span>
            <a href="#comments" class="act text-decoration-none" id="commentAct">
              <i class="bi bi-chat-square"></i><span class="num" id="cmtNum">0</span>
            </a>
            <a id="copyLinkBtn" href="#" class="act text-decoration-none text-black"><span>링크복사</span></a>
          </div>
          <div class="act-right">
            <span class="act" id="viewAct" aria-label="조회수">
              <i class="bi bi-eye"></i><span class="num" id="viewNum">0</span>
            </span>
          </div>
        </div>

        <div class="detail-foot"><a class="btn btn-outline-secondary" href="/community.html?tab=reviews">목록</a><a class="btn btn-outline-secondary" href="/community/reviews/3/edit">수정</a><a class="btn btn-outline-danger" href="/community/reviews/3/delete">삭제</a></div>

        <!-- ✅ 댓글: 본문 아래로 이동 -->
        <section class="cmt-wrap mt-3" id="comments" aria-label="댓글">
          <div class="cmt-head">
            <span>댓글 <span class="count" id="cmtHeadNum">0</span></span>
          </div>

          <div class="cmt-row">
            <span class="avatar"><img src="https://i.pravatar.cc/80?img=12" alt=""></span>
            <div class="flex-grow-1 d-flex flex-column">
              <div class="cmt-author-line">
                <span class="cmt-author">최유정</span>
                <span class="cmt-meta">· 2025-08-16</span>
              </div>
              <p class="cmt-text">설명 깔끔+샘플 다양해서 메모 꽉 채웠어요!</p>
              <button class="cmt-del">삭제</button>
            </div>
          </div>

          <div class="cmt-row">
            <span class="avatar"><img src="https://i.pravatar.cc/80?img=30" alt=""></span>
            <div class="flex-grow-1 d-flex flex-column">
              <div class="cmt-author-line">
                <span class="cmt-author">이한솔</span>
                <span class="cmt-meta">· 2025-08-16</span>
              </div>
              <p class="cmt-text">치즈 페어링 열려있으면 같이 가요!</p>
              <button class="cmt-del">삭제</button>
            </div>
          </div>

          <form class="cmt-form">
            <textarea class="form-control" placeholder="댓글을 입력하세요" aria-label="댓글"></textarea>
            <button class="btn btn-dark" type="button" id="addCmtBtn">등록</button>
          </form>
        </section>
        <!-- ✅ 댓글 끝 -->
      </section>
    </div>
  </div></div>
</main>

<!-- 링크복사 토스트 -->
<div id="shareToast" class="toast-lite" role="status" aria-live="polite" aria-atomic="true">
  <span>링크가 복사되었습니다</span>
  <button type="button" class="btn btn-copy-ok">확인</button>
  <button type="button" class="btn btn-close-lite" aria-label="닫기"><i class="bi bi-x-lg"></i></button>
</div>

<!-- ✅ 삭제 확인 모달 -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="border-radius:12px">
      <div class="modal-header border-0 pb-0">
        <h5 class="modal-title fw-bold">삭제하시겠습니까?</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
      </div>
      <div class="modal-body pt-2 text-secondary">이 작업은 되돌릴 수 없습니다.</div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">아니요</button>
        <a id="confirmYes" class="btn btn-danger" href="#">예</a>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
/* ===== Tooltip & 카테고리 패널 ===== */
const tooltips=[];
document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(el=>{
  tooltips.push(new bootstrap.Tooltip(el,{placement:'bottom',fallbackPlacements:[]}));
});
const tooltipDisposeOn = el => bootstrap.Tooltip.getInstance(el)?.dispose();
const tooltipEnableOn  = el => { if(!bootstrap.Tooltip.getInstance(el)) new bootstrap.Tooltip(el,{placement:'bottom',fallbackPlacements:[]}); };

const categories=[
  {title:'아웃도어',emoji:'🏕️'},{title:'피트니스',emoji:'🧘'},{title:'뷰티',emoji:'💄'},{title:'공예·DIY',emoji:'🧶'},
  {title:'스포츠',emoji:'⚽'},{title:'베이킹',emoji:'🍞'},{title:'문화예술',emoji:'🎨'},{title:'자기계발',emoji:'📚'},
  {title:'심리·상담',emoji:'☕'},{title:'수상레포츠',emoji:'🏊'},{title:'요리',emoji:'🍳'},{title:'여행',emoji:'✈️'}
];
function renderChips(container){
  if(!container) return;
  container.innerHTML = categories.map(c=>(
    '<button type="button" class="cat-chip" data-title="'+c.title+'">'+
      '<div class="chip-badge">'+c.emoji+'</div>'+
      '<div class="cat-title">'+c.title+'</div>'+
    '</button>'
  )).join('');
}
renderChips(document.getElementById('gridDesk'));
renderChips(document.getElementById('gridM'));

function setUnifiedChipWidth(scope=document){
  const chips=[...scope.querySelectorAll('.cat-chip')]; if(!chips.length) return;
  chips.forEach(ch=>ch.style.width='auto');
  const maxW=Math.ceil(Math.max(...chips.map(ch=>ch.scrollWidth)));
  const clamped=Math.min(Math.max(maxW,120),200);
  document.documentElement.style.setProperty('--chip-col-w',clamped+'px');
  chips.forEach(ch=>ch.style.width='100%');
}
setUnifiedChipWidth(document);
if(document.fonts?.ready) document.fonts.ready.then(()=>setUnifiedChipWidth(document));
addEventListener('resize', ()=>setUnifiedChipWidth(document));

const btnCatDesk=document.getElementById('btnCatDesk');
const panelDesk=document.getElementById('panelDesk');
function keepPanelOnScreen(panel){
  panel.style.left='50%'; panel.style.right='';
  panel.style.transform='translateX(-50%)';
  const prev=panel.style.display; panel.style.display='block';
  const rect=panel.getBoundingClientRect(); const vw=innerWidth; const m=16;
  if(rect.left<m){ panel.style.left=m+'px'; panel.style.right=''; panel.style.transform='none'; }
  else if(rect.right>vw-m){ panel.style.left=''; panel.style.right=m+'px'; panel.style.transform='none'; }
  panel.style.display=prev||'block';
}
btnCatDesk?.addEventListener('click',()=>{
  const open=panelDesk.style.display==='block';
  if(!open){ panelDesk.style.display='block'; keepPanelOnScreen(panelDesk); tooltipDisposeOn(btnCatDesk); }
  else{ panelDesk.style.display='none'; tooltipEnableOn(btnCatDesk); }
  btnCatDesk.setAttribute('aria-expanded',String(!open));
});
document.addEventListener('click',e=>{
  if(panelDesk && panelDesk.style.display==='block'&&!panelDesk.contains(e.target)&&!btnCatDesk.contains(e.target)){
    panelDesk.style.display='none'; btnCatDesk.setAttribute('aria-expanded','false'); tooltipEnableOn(btnCatDesk);
  }
});

const btnCatM=document.getElementById('btnCatM');
const panelM=document.getElementById('panelM');
function openMobilePanel(){ if(!panelM) return; panelM.style.display='block'; btnCatM?.setAttribute('aria-expanded','true'); setUnifiedChipWidth(panelM); tooltipDisposeOn(btnCatM); }
function closeMobilePanel(){ if(!panelM) return; panelM.style.display='none'; btnCatM?.setAttribute('aria-expanded','false'); tooltipEnableOn(btnCatM); }
function panelMHidden(){ return !panelM || panelM.style.display!=='block'; }
btnCatM?.addEventListener('click',e=>{ e.preventDefault(); panelMHidden()?openMobilePanel():closeMobilePanel(); });
document.addEventListener('click',e=>{
  if(!panelM) return;
  const isInside=panelM.contains(e.target)||btnCatM?.contains(e.target);
  if(!isInside&&!panelMHidden()) closeMobilePanel();
});

/* ===== 검색 오버레이(인기/최근) — main과 동일 동작 ===== */
(function(){
  const input = document.getElementById('globalSearch');
  const overlay = document.getElementById('searchOverlay');
  const popularEl = document.getElementById('popularChips');
  const recentEl = document.getElementById('recentChips');
  const clearRecentBtn = document.getElementById('clearRecent');
  if(!input || !overlay) return;

  function suppressBrowserSuggestions(el){
    el.setAttribute('autocomplete','off'); el.setAttribute('readonly','readonly'); setTimeout(()=>{ el.removeAttribute('readonly'); }, 50);
  }
  const popular = ['하이킹','보드게임','드로잉','와인클래스','홈쿠킹','사진산책','러닝'];
  const LS_KEY = 'hobby_recent_keywords';
  const getRecent = () => { try { return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); } catch { return []; } };
  const setRecent = (arr) => localStorage.setItem(LS_KEY, JSON.stringify(arr.slice(0,12)));

  function renderChips(list, container, {deletable=false}={}){
    container.innerHTML = '';
    list.forEach((word, idx)=>{
      const chip = document.createElement('button');
      chip.type = 'button';
      chip.className = 'so-chip';
      chip.setAttribute('data-word', word);
      chip.innerHTML = '<span class="txt">'+word+'</span>' + (deletable? '<span class="del" data-index="'+idx+'" aria-label="삭제">×</span>':'');
      container.appendChild(chip);
    });
  }

  function openOverlay(){
    overlay.setAttribute('aria-hidden','false');
    const wrap = input.closest('.search-wrap') || input.parentElement;
    if (wrap) {
      const rect = wrap.getBoundingClientRect();
      overlay.style.width = rect.width + 'px';
    }
  }
  function closeOverlay(){
    overlay.setAttribute('aria-hidden','true');
    overlay.querySelectorAll('.kb-focus').forEach(el=>el.classList.remove('kb-focus'));
  }

  renderChips(popular, popularEl, {deletable:false});
  renderChips(getRecent(), recentEl, {deletable:true});

  input.addEventListener('focus', ()=>{ suppressBrowserSuggestions(input); openOverlay(); });
  input.addEventListener('input', openOverlay);
  document.addEventListener('click', (e)=>{ if (overlay.contains(e.target) || input.contains(e.target)) return; closeOverlay(); });
  document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape') closeOverlay(); });

  overlay.addEventListener('click', (e)=>{
    const del = e.target.closest('.del');
    if (del){ const idx = Number(del.dataset.index); const arr = getRecent(); arr.splice(idx,1); setRecent(arr); renderChips(arr, recentEl, {deletable:true}); return; }
    const chip = e.target.closest('.so-chip'); if (!chip) return;
    const word = chip.dataset.word || chip.querySelector('.txt')?.textContent || '';
    if (!word) return;
    const arr = getRecent().filter(v=>v!==word); arr.unshift(word); setRecent(arr); renderChips(arr, recentEl, {deletable:true});
    closeOverlay();
  });

  input.addEventListener('keydown', (e)=>{
    if (e.key === 'Enter'){
      const word = (input.value || '').trim(); if (!word) return;
      const arr = getRecent().filter(v=>v!==word); arr.unshift(word); setRecent(arr); renderChips(arr, recentEl, {deletable:true}); closeOverlay();
    }
    if (['ArrowDown','ArrowUp'].includes(e.key)){
      const focusables = overlay.querySelectorAll('.so-chip'); if (!focusables.length) return;
      e.preventDefault(); const first = focusables[0]; focusables.forEach(el=>el.classList.remove('kb-focus')); first.classList.add('kb-focus'); first.scrollIntoView({block:'nearest', inline:'nearest'});
    }
  });

  overlay.addEventListener('keydown', (e)=>{
    const chips = [...overlay.querySelectorAll('.so-chip')]; if (!chips.length) return;
    const current = overlay.querySelector('.so-chip.kb-focus'); const idx = chips.indexOf(current);
    if (e.key === 'ArrowDown' || e.key === 'ArrowRight'){ e.preventDefault(); const next = chips[(idx+1+chips.length)%chips.length]; chips.forEach(el=>el.classList.remove('kb-focus')); next.classList.add('kb-focus'); next.scrollIntoView({block:'nearest', inline:'nearest'}); }
    else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft'){ e.preventDefault(); const prev = chips[(idx-1+chips.length)%chips.length]; chips.forEach(el=>el.classList.remove('kb-focus')); prev.classList.add('kb-focus'); prev.scrollIntoView({block:'nearest', inline:'nearest'}); }
    else if (e.key === 'Enter'){ e.preventDefault(); current?.click(); }
  });

  document.getElementById('clearRecent')?.addEventListener('click', ()=>{ setRecent([]); renderChips([], recentEl, {deletable:true}); });
})();

/* 모바일 입력 자동완성 억제 */
(function(){
  const sm = document.getElementById('globalSearchSm');
  if(!sm) return;
  function suppress(el){ el.setAttribute('autocomplete','off'); el.setAttribute('readonly','readonly'); setTimeout(()=>{ el.removeAttribute('readonly'); }, 50); }
  sm.addEventListener('focus', ()=> suppress(sm));
})();

/* ===== 상세 페이지 로직 ===== */
// 더보기
const bodyEl=document.getElementById('detailBody'), btnML=document.getElementById('btnMoreLess');
if(bodyEl){
  const needsMore=bodyEl.scrollHeight>bodyEl.clientHeight+4;
  if(needsMore&&btnML){btnML.style.display='inline-block';}
  btnML&&btnML.addEventListener('click',e=>{e.preventDefault(); const expanded=bodyEl.classList.toggle('collapsed')===false;
    btnML.setAttribute('aria-expanded',String(expanded)); btnML.textContent=expanded?'접기':'더보기';});
}

// 좋아요
const likeBtn=document.getElementById('likeBtn'), likeNum=document.getElementById('likeNum');
let likes=12; if(likeNum) likeNum.textContent=String(likes);
likeBtn&&likeBtn.addEventListener('click',()=>{
  const active=likeBtn.classList.toggle('active');
  likes = active ? likes+1 : Math.max(0, likes-1);
  likeBtn.setAttribute('aria-pressed',active?'true':'false');
  likeNum.textContent=String(likes);
});

// 댓글 수 집계
function renderCounts(){ const n=document.querySelectorAll('.cmt-row').length;
  const c1=document.getElementById('cmtNum'), c2=document.getElementById('cmtHeadNum'); if(c1) c1.textContent=String(n); if(c2) c2.textContent=String(n);
}
renderCounts();

// 조회수
let views=124;
const viewNum=document.getElementById('viewNum'), metaViews=document.getElementById('metaViews');
if(viewNum) viewNum.textContent=String(views);
if(metaViews) metaViews.textContent=`조회 ${views}`;

// 링크복사
const copyBtn=document.getElementById('copyLinkBtn'), toast=document.getElementById('shareToast');
const okBtn=document.querySelector('.btn-copy-ok'), closeBtn=document.querySelector('.btn-close-lite');
function showToast(){ toast.classList.add('show'); setTimeout(()=>toast.classList.remove('show'), 2000); }
copyBtn&&copyBtn.addEventListener('click',async e=>{
  e.preventDefault();
  try{ await navigator.clipboard.writeText(location.href);}catch(_){ }
  showToast();
});
okBtn&&okBtn.addEventListener('click',()=>toast.classList.remove('show'));
closeBtn&&closeBtn.addEventListener('click',()=>toast.classList.remove('show'));

// 댓글 추가/삭제
const addBtn=document.getElementById('addCmtBtn');
addBtn&&addBtn.addEventListener('click',()=>{
  const form=addBtn.closest('.cmt-form'); const ta=form.querySelector('textarea'); const txt=ta.value.trim(); if(!txt) return;
  const wrap=form.closest('.cmt-wrap'); const listAnchor=form; /* 아래 추가 방식 유지 */
  const el=document.createElement('div'); el.className='cmt-row';
  el.innerHTML=''
    + '<span class="avatar"><img src="https://i.pravatar.cc/80?u='+Date.now()+'" alt=""></span>'
    + '<div class="flex-grow-1 d-flex flex-column">'
    + '  <div class="cmt-author-line"><span class="cmt-author">나</span><span class="cmt-meta">· 방금</span></div>'
    + '  <p class="cmt-text"></p>'
    + '  <button class="cmt-del">삭제</button>'
    + '</div>';
  el.querySelector('.cmt-text').textContent=txt;
  wrap.insertBefore(el, listAnchor); /* form 위(=아래로 쌓이게) */
  ta.value=''; renderCounts();
});
document.addEventListener('click',e=>{
  const del=e.target.closest('.cmt-del'); if(!del) return;
  // 모달에서 처리 → 공통 confirm 로직에서 가로챔
});

/* ===== 메인과 동일: 푸터 폭을 네비 아이콘 끝~끝에 맞추기 ===== */
function navSpanWidth(){
  const catWrap  = document.querySelector('.bar-lg .category-trigger');
  const iconRow  = document.querySelector('.bar-lg .icon-row');
  if(!catWrap || !iconRow) return null;
  const leftEdge = catWrap.getBoundingClientRect().left;
  const rightEdge= iconRow.getBoundingClientRect().right;
  return Math.max(0, rightEdge - leftEdge);
}
function syncFooterToIcons(){
  const ft = document.getElementById('ftViewport');
  if(!ft) return;
  if (window.innerWidth >= 992) {
    const span = navSpanWidth();
    if(span!=null){
      ft.style.width = span + 'px';
      ft.style.marginLeft = 'auto';
      ft.style.marginRight = 'auto';
    }
  } else {
    ft.style.width = '';
    ft.style.marginLeft = '';
    ft.style.marginRight = '';
  }
}
window.addEventListener('load', syncFooterToIcons);
window.addEventListener('resize', syncFooterToIcons);

// 인스타 핸들 동기화
const IG_HANDLE = 'yourbrand';
const igLink = document.getElementById('igLink');
if (igLink){
  igLink.href = `https://instagram.com/${IG_HANDLE}`;
  igLink.textContent = `@${IG_HANDLE}`;
}

/* ✅ 공통: 삭제 확인 모달 핸들러 (댓글/글 모두) */
(() => {
  const modalEl = document.getElementById('confirmModal');
  if(!modalEl) return;
  const modal = new bootstrap.Modal(modalEl);
  const yesBtn = document.getElementById('confirmYes');
  let onYes = null;

  yesBtn?.addEventListener('click', (e) => {
    e.preventDefault();
    try { onYes && onYes(); } finally {
      modal.hide();
      onYes = null;
    }
  });

  document.addEventListener('click', (e) => {
    // 1) 댓글 삭제 버튼
    const cmtBtn = e.target.closest('[data-cmt-del], .cmt-del');
    if (cmtBtn) {
      e.preventDefault();
      const row = cmtBtn.closest('.cmt-row');
      onYes = () => {
        row?.remove();
        if (typeof renderCounts === 'function') renderCounts();
      };
      modal.show();
      return;
    }

    // 2) 글 삭제 링크 (href에 /delete 포함)
    const delLink = e.target.closest('a[href*="/delete"]');
    if (delLink) {
      e.preventDefault();
      const href = delLink.getAttribute('href') || '#';
      onYes = () => { location.href = href; };
      modal.show();
      return;
    }
  });
})();
</script>

<!-- ===== 푸터(회색 박스) ===== -->
<section class="footer-wrap">
  <div class="container">
    <div id="ftViewport" class="footer-viewport mx-auto">
      <footer class="footer-box" role="contentinfo">
        <div>
          <div class="ft-title">help</div>
          <a href="#">FAQ</a>
          <a href="#">Contact</a>
        </div>

        <div>
          <div class="ft-title">news</div>
          <a href="#">Notice</a>
          <a href="#">Update</a>
        </div>

        <div>
          <div class="ft-title"><i class="fa-brands fa-instagram"></i> instagram</div>
          <a id="igLink" href="https://instagram.com/yourbrand" target="_blank" rel="noopener">@yourbrand</a>
        </div>
      </footer>
    </div>
  </div>
</section>

<script>
/* rd-align-rails-only: align header/main .rail width to nav span (desktop only) */
(function(){
  function navSpan(){
    var cat = document.querySelector('.bar-lg .category-trigger');
    var icons = document.querySelector('.bar-lg .icon-row');
    if(!cat || !icons) return null;
    var l = cat.getBoundingClientRect().left;
    var r = icons.getBoundingClientRect().right;
    return {left:l, right:r, span: Math.max(0, r - l)};
  }
  function rdAlignRails(){
    var desktop = window.innerWidth >= 992;
    var rails = document.querySelectorAll('main .container > .rail');
    if(!rails.length){ return; }
    if(!desktop){
      rails.forEach(function(el){
        el.style.width=''; el.style.marginLeft=''; el.style.marginRight='';
      });
      return;
    }
    var ns = navSpan();
    rails.forEach(function(el){
      var cont = el.closest('.container');
      if(!(ns && cont)){ el.style.width=''; el.style.marginLeft=''; el.style.marginRight=''; return; }
      var crect = cont.getBoundingClientRect();
      var ml = Math.max(0, ns.left - crect.left);
      el.style.width = ns.span + 'px';
      el.style.marginLeft = ml + 'px';
      el.style.maxWidth = 'none';
      el.style.marginRight = '';
    });
  }
  window.addEventListener('load', rdAlignRails);
  window.addEventListener('resize', rdAlignRails);
  if (document.fonts && document.fonts.ready) { document.fonts.ready.then(rdAlignRails); }
  window.rdAlignRails = rdAlignRails;
})();
</script>

<script>
/* rd-align-rails-only */
(function(){
  function navSpan(){
    var cat = document.querySelector('.bar-lg .category-trigger');
    var icons = document.querySelector('.bar-lg .icon-row');
    if(!cat || !icons) return null;
    var l = cat.getBoundingClientRect().left;
    var r = icons.getBoundingClientRect().right;
    return {left:l, right:r, span: Math.max(0, r - l)};
  }
  function alignTargets(){
    var desktop = window.innerWidth >= 992;
    var targets = document.querySelectorAll('header.page-header .container > .rail, main .container > .rail, #ftViewport .footer-box');
    if(!targets.length) return;
    if(!desktop){
      targets.forEach(function(el){
        el.style.width=''; el.style.marginLeft=''; el.style.marginRight=''; el.style.maxWidth='';
      });
      return;
    }
    var ns = navSpan();
    var FOOTER_LEFT_BIAS = -10; // footer만 살짝 왼쪽으로 2px 이동
    targets.forEach(function(el){
      var cont = el.closest('.container') || el.parentElement;
      if(!(ns && cont)){
        el.style.width=''; el.style.marginLeft=''; el.style.marginRight=''; el.style.maxWidth='';
        return;
      }
      var crect = cont.getBoundingClientRect();
      var ml = Math.max(0, ns.left - crect.left);
      var appliedML = Math.round(ml);
      if (el.matches && el.matches('#ftViewport .footer-box')) {
        appliedML = Math.round(ml + FOOTER_LEFT_BIAS);
      }
      el.style.width = Math.round(ns.span) + 'px';
      el.style.marginLeft = appliedML + 'px';
      el.style.marginRight = '0px';
      el.style.maxWidth = 'none';
    });
  }
  window.addEventListener('load', alignTargets);
  window.addEventListener('resize', alignTargets);
  if (document.fonts && document.fonts.ready) { document.fonts.ready.then(alignTargets); }
  window.rdAlignRails = alignTargets;
})();
</script>
<script>
/* rd-footer-force */
(function(){
  function headerSpan(){
    // use the visible breadcrumb/section line as reference
    var rail = document.querySelector('header.page-header .container > .rail');
    if(!rail) return null;
    var r = rail.getBoundingClientRect();
    return {left:r.left, right:r.right, span: Math.max(0, r.right - r.left)};
  }
  function applyFooterForce(){
    var desktop = window.innerWidth >= 992;
    var ft = document.querySelector('#ftViewport .footer-box');
    if(!ft) return;
    var st = document.getElementById('rd-footer-force-style');
    if(!desktop){
      if(st) st.remove();
      ft.style.maxWidth='';
      return;
    }
    var hs = headerSpan();
    if(!hs) return;
    var cont = ft.closest('.container') || ft.parentElement;
    var crect = cont.getBoundingClientRect();
    var ml = Math.max(0, hs.left - crect.left);
    var w = Math.max(0, hs.right - hs.left);
    var BIAS = -6; // move a bit further left
    var cssText = ""
      + "#ftViewport{width:100% !important; margin-left:0 !important; margin-right:0 !important;}"
      + "#ftViewport .footer-box{"
      +   "margin-left:" + Math.round(ml + BIAS) + "px !important;"
      +   "width:" + Math.round(w) + "px !important;"
      +   "max-width:none !important;"
      +   "margin-right:0 !important;"
      + "}";
    if(!st){
      st = document.createElement('style');
      st.id = 'rd-footer-force-style';
      document.head.appendChild(st);
    }
    st.textContent = cssText;
  }
  window.addEventListener('load', applyFooterForce);
  window.addEventListener('resize', applyFooterForce);
  if (document.fonts && document.fonts.ready) { document.fonts.ready.then(applyFooterForce); }
  window.rdFooterForce = applyFooterForce;
})();
</script>
</body>
</html>
